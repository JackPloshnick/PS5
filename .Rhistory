h=((b-a)/n)
first_value= y[1]
last_vlaue= tail(y, n=1)
second_to_last= 4* head(tail(y, n=2), n=1)
middle_vlaues= y[2:(length(x)-2)]
odd_middles= 4*middle_vlaues[seq(1,length(middle_vlaues),2)]
even_middles= 2*middle_vlaues[seq(0,length(middle_vlaues),2)]
answer= (h/3)* sum(first_value, odd_middles, even_middles,second_to_last, last_vlaue)
print(answer)
}
simpsons(x,y,StartToEnd)
x<- c(1,2,3,4,5)
y<- c(1,4,9,16,25)
StartToEnd<- c(1:5)
trap<- function(x,y,StartToEnd){
a= x[StartToEnd[1]]
b= x[tail(StartToEnd, n=1)]
n= as.numeric(length(StartToEnd))
h=((b-a)/n)
first_value= y[1]
last_vlaue= tail(y, n=1)
middle_vlaues= 2* y[2:(length(x)-1)]
answer= (h/2) * sum(first_value, last_vlaue, middle_vlaues)
print(answer)
}
trap(x,y,StartToEnd)
simpsons <- function(x,y,StartToEnd){
a= x[StartToEnd[1]]
b= x[tail(StartToEnd, n=1)]
n= as.numeric(length(StartToEnd))
h=((b-a)/n)
first_value= y[1]
last_vlaue= tail(y, n=1)
second_to_last= 4* head(tail(y, n=2), n=1)
middle_vlaues= y[2:(length(x)-2)]
odd_middles= 4*middle_vlaues[seq(1,length(middle_vlaues),2)]
even_middles= 2*middle_vlaues[seq(0,length(middle_vlaues),2)]
answer= (h/3)* sum(first_value, odd_middles, even_middles,second_to_last, last_vlaue)
print(answer)
}
simpsons(x,y,StartToEnd)
trap(x,y,StartToEnd)
source('~/GitHub/PS5/Trapezoid.R')
setClass(Class="Trapezoid",  #Sets S4 class of door
representation = representation(
x_values = "numeric", # three slots as specified in problem set
y_values = "numeric", #Numeric, Numeric, Logical
estimate = "numeric"
),
prototype = prototype(
chosenDoor = c(), #default values are empty
carDoor = c(),
switch = c()
)
)
setClass(Class="Trapezoid",  #Sets S4 class of door
representation = representation(
x_values = "numeric", # three slots as specified in problem set
y_values = "numeric", #Numeric, Numeric, Logical
estimate = "numeric"
),
prototype = prototype(
x_values = c(), #default values are empty
y_values = c(),
estimate = c()
)
)
setValidity("Trapezoid", function(object){
estimateLength = (length(object@estimate == 1))
valuesLength= (length(object@x_values)== length(object@y_values))
if(!estimateLength | !valuesLength){
return("Trapezoid not valid")
}
})
trap(x,y,StartToEnd)
new("Trapezoid", x_values= x, y_values= y, estimate= 33.6)
new("Trapezoid", x_values= x, y_values= y, estimate= TRUE)
setMethod("initialize", "Trapezoid", function(.Object, ...) { #initilize method
value = callNextMethod()
validObject(value)
return(value)
})
source('~/GitHub/PS5/Trapezoid.R')
setClass(Class="Simpson",  #Sets S4 class of door
representation = representation(
x_values = "numeric", # three slots as specified in problem set
y_values = "numeric",
estimate = "numeric"
),
prototype = prototype(
x_values = c(), #default values are empty
y_values = c(),
estimate = c()
)
)
setValidity("Simpson", function(object){
estimateLength = (length(object@estimate == 1))
valuesLength= (length(object@x_values)== length(object@y_values))
if(!estimateLength | !valuesLength){
return("Simpson not valid")
}
})
new("Simpson", x_values= x, y_values= y, estimate= 33.6)
setMethod("initialize", "Simpson", function(.Object, ...) { #initilize method
value = callNextMethod()
validObject(value)
return(value)
})
source('~/GitHub/PS5/Trapezoid.R')
setGeneric("integrateIt", #sets generic function in S4
function(object) {
standardGeneric("integrateIt")
} )
setGeneric("integrateIt", #sets generic function in S4
function(x,y,Starting_Ending_Values,type) {
standardGeneric("integrateIt")
} )
setMethod("integrateIt",
function(x,y,Starting_Ending_Values,type){
print("test")
})
setClass(Class="input",  #Sets S4 class of door
representation = representation(
x_values = "numeric", # three slots as specified in problem set
y_values = "numeric",
start_end_values = "numeric",
test= "character"
),
prototype = prototype(
x_values = c(), #default values are empty
y_values = c(),
start_end_values = c(),
test= c()
)
)
setValidity("", function(object){
valuesLength= (length(object@x_values)== length(object@y_values))
if( !valuesLength){
return("Simpson not valid")
}
})
setValidity("input", function(object){
valuesLength= (length(object@x_values)== length(object@y_values))
if(!valuesLength){
return("Simpson not valid")
}
})
new("input", x_values= x, y_values= y,start_end_values= StartToEnd, test= "Trap")
setMethod("initialize", "input", function(.Object, ...) { #initilize method
value = callNextMethod()
validObject(value)
return(value)
})
setMethod("integrateIt", "input",
function(x,y,Starting_Ending_Values,type){
print("test")
})
source('~/GitHub/PS5/Trapezoid.R')
setMethod("integrateIt", "input",
function(x,y,Starting_Ending_Values,type){
if(input@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
tester
setMethod("integrateIt", "input",
function(x,y,Starting_Ending_Values,type){
if(input@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setMethod("integrateIt", "input",
function(object){
if(input@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
setGeneric("integrateIt", #sets generic function in S4
function(object) {
standardGeneric("integrateIt")
} )
setMethod("integrateIt", "input",
function(object){
if(input@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setGeneric("integrateIt", #sets generic function in S4
function(object= "input") {
standardGeneric("integrateIt")
} )
setMethod("integrateIt", "input",
function(object){
if(input@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setMethod("initialize", "input", function(.Object, ...) { #initilize method
value = callNextMethod()
validObject(value)
return(value)
})
setGeneric("integrateIt", #sets generic function in S4
function(object= "input") {
standardGeneric("integrateIt")
} )
setMethod("integrateIt", "input",
function(object){
if(input@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
setMethod("integrateIt", "input",
function(object){
if(object@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
return(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setMethod("integrateIt", "input",
function(object){
if(object@test== "Trap"){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
print(Trap)
}
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setMethod("integrateIt", "input",
function(object){
Trap= new("Trapezoid", x= object@x_values, y= object@y_values, estimate=
trap(object@x_values, object@y_values, object@start_end_values))
print(Trap)
})
tester<- new("input", x_values= x, y_values= y, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setClass(Class="input",  #Sets S4 class of door
representation = representation(
x = "numeric", # three slots as specified in problem set
y = "numeric",
start_end_values = "numeric",
test= "character"
),
prototype = prototype(
x = c(), #default values are empty
y = c(),
start_end_values = c(),
test= c()
)
)
setClass(Class="input",  #Sets S4 class of door
representation = representation(
x = "numeric", # three slots as specified in problem set
y = "numeric",
start_end_values = "numeric",
test= "character"
),
prototype = prototype(
x = c(), #default values are empty
y = c(),
start_end_values = c(),
test= c()
)
)
setValidity("input", function(object){
valuesLength= (length(object@x)== length(object@y))
if(!valuesLength){
return("Simpson not valid")
}
})
x.test<- c(1,2,3,4,5)
y.test<- c(1,4,9,16,25)
tester<- new("input", x= x.test, y_values= y.test,start_end_values= StartToEnd, test= "Trap")
tester<- new("input", x= x.test, y= y.test,start_end_values= StartToEnd, test= "Trap")
setMethod("initialize", "input", function(.Object, ...) { #initilize method
value = callNextMethod()
validObject(value)
return(value)
})
setGeneric("integrateIt", #sets generic function in S4
function(object= "input") {
standardGeneric("integrateIt")
} )
setMethod("integrateIt", "input",
function(object){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
})
tester<- new("input", x= x.test, y= y.test, start_end_values= StartToEnd, test= "Trap")
integrateIt(tester)
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)}
if(test= "Simpson"){
Simpson= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Trap)}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)}
if(test= "Simpson"){
Simpson= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpson)}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
}
if(test= "Simpson"){
Simpson= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpson)
}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
}
if(test= "Simpson"){
Simpsons= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpsons)
}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
}
if(test= "Simpson"){
Simpsons= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpsons)
}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
}
if(test= "S"){
Simpsons= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpsons)
}
})
setGeneric("integrateIt", #sets generic function in S4
function(object= "input") {
standardGeneric("integrateIt")
} )
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
}
if(test= "Simpson"){
Simpson= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpson)
}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)}
if(test= "Simpson"){
Simpson= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpson)}
})
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)}
else{
Simpson= new("Simpson", x_values= object@x, y_values= object@y, estimate=
simpsons(object@x, object@y, object@start_end_values))
print(Simpson)}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
}
})
setMethod("integrateIt", "input",
function(object){
Trap= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
print(Trap)
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
result= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
}
print(result)
})
source('~/GitHub/PS5/Trapezoid.R')
setGeneric("integrateIt", #sets generic function in S4
function(object= "input") {
standardGeneric("integrateIt")
} )
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
result= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
}
print(result)
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
result= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
}
})
setMethod("integrateIt", "input",
function(object){
if(test= "Trap"){
result= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
}
} )
setMethod("integrateIt", "input",
function(object){
if(test="Trap"){ #if cardoor and chosen door are the same, randomly choose between the two remaining doors
result= new("Trapezoid", x_values= object@x, y_values= object@y, estimate=
trap(object@x, object@y, object@start_end_values))
}
} )
source('~/GitHub/PS5/Trapezoid.R')
setwd("~/GitHub/PS5")
install.packages("integrateIt")
source("integrateIt")
package<- as.package("integrateIt")
library(devtools)
library(roxygen2)
current.code <- as.package("integrateIt")
load_all(current.code)
x.test<- c(1,2,3,4,5)
y.test<- c(1,4,9,16,25)
StartToEnd<- c(1:5)
test<- trap(x.test, y.test, StartToEnd)
simpsons(x.test,y.test,StartToEnd)
S<- integrateIt(x.test,y.test,StartToEnd,"Simpson")
T<- integrateIt(x.test,y.test,StartToEnd,"Trap")
print(test)
check(current.code)
